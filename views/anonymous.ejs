<!DOCTYPE html>
<html lang="KOR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/public/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <title>중고마켓</title>
  </head>
  <body>
    <%- include('userNav.html')%>

    <div>이웃주민과 자유롭게 소통해 보세요.</div>

    <button id="socketChatRoom1">socketChatroom1</button>

    <ul class="socket-message-content">
      <!-- 서버로부터 온 메세지 화면에 띄우기 <li></li> -->
    </ul>
    <input id="send-socket-input" />
    <button id="send-socket">전송</button>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.socket.io/4.5.3/socket.io.min.js"
      integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi"
      crossorigin="anonymous"
    ></script>
    <script>
      //웹소켓 접속
      const socket = io();

      //채팅방1에 접속을 요구
      $("#socketChatRoom1").click(() => {
        socket.emit("joinRoom1", "입장요청");
      });

      //서버에 메세지 보내기 (emit:신호를 내뿜다 라는 뜻)
      $("#send-socket").click(() => {
        socket.emit("user", $("#send-socket-input").val());
      });

      //서버로부터 메세지 수신
      socket.on("broadcast", (data) => {
        $(".socket-message-content").append(`<li> ${data} </li>`);
      });
    </script>
  </body>
</html>
